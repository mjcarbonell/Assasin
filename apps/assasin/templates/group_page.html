[[extend 'layout.html']]

<style>
    [v-cloak] {
         display: none;
    }
</style>

<div class="section" id="vue-target" v-cloak>

    <h1 class="title is-3 has-text-centered">
        <img src="images/wizard.jpg" alt="Group Icon" class="group-icon" style="width: 200px; height: 200px;">
        <span class="is-size-4">Group Page</span>
    </h1>
    <h1 class="tag is-link is-dark is-medium"> Must have 3 players in a group to start</h1>
      
    <h1 style="margin-bottom: 20px;">&nbsp;</h1>



    <h2 v-for="group in groups">
        <!-- SHOW ALL GROUPS with active creators HERE -->
        <div class="group-wrapper">
            <a class="button" @click="add_yourself(group.id)">{{group.creator}}'s group</a>
            <span class="tag is-yellow">total players: {{group.total_players}}</span>
            <a v-if="group.total_players >= 3" class="button is-primary" @click="start_game(group.id)">
                <span class="icon"></span> 
                <span>set active</span>
            </a>
        
        </div>
        <template v-for="player in players">
            <h2 v-if="group.id === player.group_id">
                <div>
                    <span class="tag is-info">{{player.username}}</span>
                </div>
            </h2>
        </template>
    </h2>

      

    
    <h1 style="margin-bottom: 20px;">&nbsp;</h1>

    <a v-if="active_group != null" class="button is-primary " href="[[=URL('game_page', signer=url_signer)]]">
        <span class="icon"></span> 
        <span>{{active_group.creator}}'s group is active </span>
        <h1 style="margin-bottom: 20px;">&nbsp;</h1>
        <span>click here to go it </span>
    </a>

    <h2> 
        <!-- we create a group and change the user's group id to new group -->
        <button class="button is-link" @click="create_group">create a group!</button>
    </h2>

    <a class="button" href="[[=URL('statistics_page', signer=url_signer)]]">
        <span class="icon">Go to statistics</span>
    </a>

</div>









[[block page_scripts]]
<!-- Loads the index-specific js for Vue -->
<script>
  let get_users_url = "[[=XML(get_users_url)]]";
  let add_player_url = "[[=XML(add_player_url)]]";
  let get_groups_url = "[[=XML(get_groups_url)]]";
  let create_group_url = "[[=XML(create_group_url)]]"; 
  let change_id_url = "[[=XML(change_id_url)]]"; 
  let delete_group_url = "[[=XML(delete_group_url)]]"; 
  let set_active_url = "[[=XML(set_active_url)]]";
</script>

<script src="js/group_page.js"></script>
[[end]]
